<!-- 定损报告详情（从历史进入） -->
<custom-nav-bar title="定损报告" showBack="{{true}}" />
<view class="page-root report-page" style="{{pageRootStyle}}">
  <block wx:if="{{loading}}">
    <view class="report-loading">
      <text class="text-muted fs-body">加载中...</text>
    </view>
  </block>
  <block wx:elif="{{error}}">
    <view class="report-error card">
      <text class="text-muted fs-body">{{error}}</text>
      <navigator class="report-link" url="/pages/damage/history/index">返回历史</navigator>
    </view>
  </block>
  <block wx:elif="{{report}}">
    <scroll-view class="report-scroll" scroll-y style="{{scrollStyle}}">
      <view class="report-card card">
        <view class="report-title fs-h3 fw-bold">定损报告</view>
        <view class="report-row">
          <text class="report-label">损伤等级</text>
          <text class="report-value">{{report.damage_level === '无伤' ? '无伤' : report.damage_level + '损伤'}}</text>
        </view>
        <view class="report-row" wx:if="{{report.total_estimate && report.total_estimate.length >= 2}}">
          <text class="report-label">预估费用</text>
          <text class="report-value">{{report.total_estimate[0]}}-{{report.total_estimate[1]}} 元</text>
        </view>
        <view class="report-damages" wx:if="{{report.damages && report.damages.length}}">
          <view class="fs-body fw-bold">损伤部位</view>
          <view class="report-damage-item" wx:for="{{report.damages}}" wx:key="index">
            <text class="fs-body">{{item.part}}：{{item.type}}</text>
          </view>
        </view>
        <view class="report-repair" wx:if="{{report.repair_suggestions && report.repair_suggestions.length}}">
          <view class="fs-body fw-bold">维修建议</view>
          <view class="report-repair-item" wx:for="{{report.repair_suggestions}}" wx:key="index">
            <text class="fs-body">{{item.item}}</text>
          </view>
        </view>
      </view>
      <view class="report-actions">
        <navigator class="report-btn btn-primary" url="/pages/damage/upload/index?id={{reportId}}">
          <text class="fs-body fw-bold">发起竞价</text>
        </navigator>
      </view>
      <view class="report-bottom-pad"></view>
    </scroll-view>
  </block>
</view>
