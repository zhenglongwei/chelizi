<!-- 服务商注册 - M02 -->
<custom-nav-bar title="服务商注册" showBack="{{true}}" />
<view class="page-root merchant-register-page" style="{{pageRootStyle}}">
  <view class="merchant-register-content">
    <view class="merchant-register-form card">
      <view class="merchant-form-item merchant-license-first">
        <text class="merchant-form-label fs-body">营业执照 <text class="text-muted fs-cap">（上传后自动识别并填充）</text></text>
        <view class="merchant-license-upload" wx:if="{{!licensePath}}" bindtap="onChooseLicense">
          <text class="merchant-license-add">+</text>
          <text class="text-muted fs-cap">上传营业执照</text>
        </view>
        <view class="merchant-license-preview" wx:else>
          <image class="merchant-license-img" src="{{licensePath}}" mode="aspectFill"/>
          <view class="merchant-license-del" bindtap="onDelLicense">×</view>
        </view>
        <text class="merchant-license-ocr-tip text-muted fs-sm" wx:if="{{ocrLoading}}">识别中...</text>
        <text class="merchant-license-ocr-tip text-success fs-sm" wx:elif="{{ocrSuccess}}">已识别，请核对下方信息</text>
      </view>
      <view class="merchant-form-item">
        <text class="merchant-form-label fs-body">企业名称 <text class="text-danger">*</text></text>
        <input class="merchant-form-input" placeholder="请输入企业/维修厂名称" value="{{name}}" bindinput="onNameInput"/>
      </view>
      <view class="merchant-form-item">
        <text class="merchant-form-label fs-body">营业执照号码 <text class="text-danger">*</text></text>
        <input class="merchant-form-input" placeholder="统一社会信用代码" value="{{licenseID}}" bindinput="onLicenseIDInput"/>
      </view>
      <view class="merchant-form-item">
        <text class="merchant-form-label fs-body">法定代表人 <text class="text-danger">*</text></text>
        <input class="merchant-form-input" placeholder="营业执照上的法定代表人" value="{{legalRepresentative}}" bindinput="onLegalRepresentativeInput"/>
      </view>
      <view class="merchant-form-item">
        <text class="merchant-form-label fs-body">联系人 <text class="text-danger">*</text></text>
        <input class="merchant-form-input" placeholder="日常业务联系人姓名" value="{{contact}}" bindinput="onContactInput"/>
      </view>
      <view class="merchant-form-item">
        <text class="merchant-form-label fs-body">店铺地址 <text class="text-danger">*</text></text>
        <text class="text-muted fs-cap">需在地图上选点，获取精准经纬度以计算与用户距离</text>
        <view class="merchant-location-picker" bindtap="onChooseLocation">
          <text class="merchant-location-text {{address ? 'has-value' : ''}}">{{address || '点击选择店铺位置'}}</text>
          <text class="merchant-location-hint fs-cap" wx:if="{{address}}">已选：{{locationName || '已定位'}}</text>
        </view>
      </view>
      <view class="merchant-form-item">
        <text class="merchant-form-label fs-body">手机号 <text class="text-danger">*</text></text>
        <input class="merchant-form-input" type="number" placeholder="请输入手机号" value="{{phone}}" bindinput="onPhoneInput" maxlength="11"/>
      </view>
      <view class="merchant-form-item">
        <text class="merchant-form-label fs-body">密码 <text class="text-danger">*</text></text>
        <input class="merchant-form-input" type="password" placeholder="至少 6 位" value="{{password}}" bindinput="onPasswordInput"/>
      </view>
      <view class="merchant-form-item">
        <text class="merchant-form-label fs-body">确认密码 <text class="text-danger">*</text></text>
        <input class="merchant-form-input" type="password" placeholder="请再次输入密码" value="{{confirmPassword}}" bindinput="onConfirmPasswordInput"/>
      </view>
      <button class="btn-primary merchant-register-btn" disabled="{{submitting}}" bindtap="onSubmit">
        {{submitting ? '提交中...' : '提交注册'}}
      </button>
    </view>

    <view class="merchant-register-footer">
      <text class="text-muted fs-cap">已有账号？</text>
      <text class="merchant-register-link fs-cap" bindtap="onToLogin">去登录</text>
    </view>
  </view>
</view>
