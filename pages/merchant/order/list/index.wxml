<!-- 服务商订单列表 - M06 -->
<custom-nav-bar title="我的订单" showBack="{{true}}" />
<view class="page-root merchant-order-list" style="{{pageRootStyle}}">
  <view class="merchant-tabs">
    <view class="merchant-tab {{tabIndex === -1 ? 'active' : ''}}" data-index="-1" bindtap="onTabChange">全部</view>
    <view class="merchant-tab {{tabIndex === 0 ? 'active' : ''}}" data-index="0" bindtap="onTabChange">待接单</view>
    <view class="merchant-tab {{tabIndex === 1 ? 'active' : ''}}" data-index="1" bindtap="onTabChange">维修中</view>
    <view class="merchant-tab {{tabIndex === 2 ? 'active' : ''}}" data-index="2" bindtap="onTabChange">待确认</view>
    <view class="merchant-tab {{tabIndex === 3 ? 'active' : ''}}" data-index="3" bindtap="onTabChange">已完成</view>
  </view>

  <block wx:if="{{loading && list.length === 0}}">
    <view class="merchant-loading">
      <text class="text-muted fs-body">加载中...</text>
    </view>
  </block>
  <block wx:elif="{{empty && !loading}}">
    <view class="merchant-empty card">
      <text class="text-muted fs-body">暂无订单</text>
    </view>
  </block>
  <scroll-view wx:else class="merchant-scroll" scroll-y style="{{scrollStyle}}" bindscrolltolower="onReachBottom">
    <view class="merchant-list">
      <view class="merchant-order-card card" wx:for="{{list}}" wx:key="order_id" data-id="{{item.order_id}}" bindtap="onItemTap">
        <view class="merchant-card-header">
          <text class="merchant-order-id fs-body fw-bold">{{item.order_id}}</text>
          <text class="merchant-status-badge">{{item.status_text}}</text>
        </view>
        <view class="merchant-plan-pending text-warning fs-cap" wx:if="{{item.status === 1 && item.repair_plan_status === 1}}">维修方案待确认</view>
        <view class="merchant-card-body">
          <view class="merchant-card-row">
            <text class="text-muted fs-sm">车辆：</text>
            <text class="fs-body">{{item.vehicle_display}}</text>
          </view>
          <view class="merchant-card-row">
            <text class="text-muted fs-sm">报价：</text>
            <text class="fs-body text-gold fw-bold">¥{{item.quoted_amount}}</text>
          </view>
          <view class="merchant-card-row merchant-card-meta">
            <text class="text-weak fs-sm" wx:if="{{item.complexity_level}}">{{item.complexity_level}}</text>
            <text class="text-weak fs-sm" wx:if="{{item.commission_rate}}">佣金 {{item.commission_rate}}</text>
            <text class="text-weak fs-sm">{{item.created_short}}</text>
          </view>
        </view>
      </view>
    </view>
    <view class="merchant-load-more" wx:if="{{hasMore && !loading}}">
      <text class="text-muted fs-sm">上拉加载更多</text>
    </view>
    <view class="merchant-bottom-pad"></view>
  </scroll-view>
</view>
