# 竞价单分发机制

> **定位**：以店铺评价得分为核心准入与梯队划分依据，优质商户优先拿单，彻底杜绝劣币驱逐良币。用于用户发需求撮合场景。

---

## 一、原则

先过滤，后分层，再排序。

---

## 二、前置硬门槛过滤

任一项不满足即踢出分发池：

- **距离**：在用户设定圆心距离范围内
- **资质**：具备对应维修项目资质、车型维修能力
- **合规**：季度合规率 ≥80%，近 30 天无重大违规
- **能力**：近 90 天内有同复杂度项目完单记录
- **产能**：近 24 小时内无满负荷预警

**兜底**：过滤后不足 3 家时，按 20% 幅度扩大距离直至凑够 3 家。

---

## 三、梯队划分与分发

```
服务商综合匹配分 = 店铺综合得分 × 场景权重系数 + 同项目完单量分 + 报价历史准确度分 + 时效履约率分
```

| 梯队 | 划分标准 | 分发规则 |
|------|----------|----------|
| 第一梯队 | 综合匹配分 ≥80 + 合规率 ≥95% + 无违规 | 独家推送 15 分钟报价窗口，窗口期结束后再开放其他梯队 |
| 第二梯队 | 综合匹配分 60–79 + 合规率 ≥85% | 第一梯队窗口期结束后开放 |
| 第三梯队 | 综合匹配分 ＜60 + 仅满足硬门槛 | 仅当一、二梯队有效报价不足 3 家时开放，最多 2 家 |

---

## 四、分发数量上限

- L1–L2：最多分发 10 家，有效报价满 5 家停止
- L3–L4：最多分发 15 家，有效报价满 8 家停止

---

## 五、报价排序

```
报价排序分 = 服务商综合匹配分 × 70% + 报价合理性分 × 30%
```

用户可选：价格从低到高、距离从近到远、质保期限从长到短。每条报价须展示完整配件明细、工时费、质保期限、门店资质、历史同项目案例。

---

## 六、实现参数（运营后台可配置）

| 参数 | 默认值 | 说明 |
|------|--------|------|
| filterComplianceMin | 80 | 合规率最低要求（%） |
| filterViolationDays | 30 | 重大违规统计天数 |
| fallbackDistanceExpandRate | 0.2 | 距离兜底扩大幅度 |
| fallbackMinShops | 3 | 兜底最少店铺数 |
| tier1MatchScoreMin | 80 | 第一梯队匹配分下限 |
| tier1ComplianceMin | 95 | 第一梯队合规率下限 |
| tier2MatchScoreMin | 60 | 第二梯队匹配分下限 |
| tier2MatchScoreMax | 79 | 第二梯队匹配分上限 |
| tier2ComplianceMin | 85 | 第二梯队合规率下限 |
| tier1ExclusiveMinutes | 15 | 第一梯队独家窗口（分钟） |
| tier3MaxShops | 2 | 第三梯队最多家数 |
| distributeL1L2Max | 10 | L1–L2 最多分发家数 |
| distributeL1L2ValidStop | 5 | L1–L2 有效报价满 N 家停止 |
| distributeL3L4Max | 15 | L3–L4 最多分发家数 |
| distributeL3L4ValidStop | 8 | L3–L4 有效报价满 N 家停止 |
| newShopDays | 90 | 新店定义天数 |
| newShopBaseScore | 60 | 新店基础分 |
| sameProjectScorePriority | 15 | 优先匹配（高复杂度）加分 |
| sameProjectScoreFallback | 5 | 兜底匹配加分 |

配置入口：管理后台 → 系统配置 → 竞价分发。
