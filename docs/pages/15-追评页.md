# 追评弹窗

> **评价体系变更**：追评由独立页面改为**弹窗**形式；**不限制时间与次数**，用户可随时追加点评。返厂评价等同于追评，复用本弹窗。以《评价和激励体系.md》为准。

## 基本信息

| 项目 | 说明 |
|------|------|
| 展示形式 | **弹窗**（非独立路由，无页面跳转） |
| 页面标识 | 追加点评、返厂评价 |
| 触发方式 | 订单详情/评价详情入口、消息中心、推送提醒（可选在 1 个月/3 个月推送引导） |
| 时间与次数 | **不限制**：完工后随时可追加，次数不限 |

## 页面功能概述

用户可**随时追加追评**，不限制时间与次数。弹窗 1 屏极简，10 秒可完成。

**奖励规则**（整体评估 + 差额补发）：主评价与追评视为整体，追评提交后若内容等级升级，补发差额。**判定规则**：结合质保期、追评内容类型综合评估，详见《02-评价内容质量等级体系》2.5 追评判定规则。

## 页面布局结构

| 模块 | 说明 |
|------|------|
| 订单/评价信息 | 维修厂、维修项目、完工时间、**质保期**（用于判定参考） |
| 必选客观题 | 1. 故障是否复发；2. 有无新增异常；3. 配件是否正常（可选）；4. 售后是否响应（可选） |
| 使用体验描述 | 10 字以上必填 |
| 凭证上传 | 可选：维修后实拍图、配件编号照片等（配件不匹配投诉需上传证明） |
| 奖励金提示 | 见下方「前端文案指引」 |
| 提交按钮 | 提交追评 |

## 返厂评价

返厂评价**等同于追评**，复用本弹窗流程，扩展参数 `is_return_visit: true`。用户车辆返厂维修后，通过推送/站内信或订单入口触发弹窗。

## 功能点详细说明

### 功能点 1：追评入口与条件

| 项目 | 说明 |
|------|------|
| 功能 ID | F-REVIEW-FOLLOW-001 |
| 功能描述 | 校验是否满足追评条件 |
| 入口 | 订单详情、评价详情、消息中心；可选：1 个月/3 个月推送引导 |
| 条件 | 主评价已提交；无时间与次数限制 |
| 预期结果 | 满足则展示弹窗；已取消订单等不展示 |

### 功能点 2：提交追评

| 项目 | 说明 |
|------|------|
| 功能 ID | F-REVIEW-FOLLOW-002 |
| 功能描述 | 提交追评内容 |
| 操作流程 | 填写客观题 + 描述（10 字以上）+ 可选凭证 → 点击提交 |
| 预期结果 | 调用 `POST /api/v1/reviews/{id}/followup`；扩展 `is_return_visit`；后端结合质保期等综合判定，若等级升级则补发差额 |
| 备注 | 追评与返厂评价复用同一接口，`is_return_visit` 区分 |

### 功能点 3：奖励金展示

| 项目 | 说明 |
|------|------|
| 功能 ID | F-REVIEW-FOLLOW-003 |
| 功能描述 | 展示追评可得奖励金 |
| 计算规则 | 整体评估 + 差额补发：追评提交后若等级升级，补发差额 |
| 预期结果 | 提交前显示预估；提交后显示「奖励金审核中」或「奖励金已到账」 |

## 前端文案指引（必读）

**目的**：用合适语言提醒用户做追评、提供更高质量图片，可提升内容等级进而获得更多奖金。

| 场景 | 建议文案 |
|------|----------|
| 追评弹窗顶部/主提示 | 「随时可追加使用体验，上传更多实拍图，有机会提升内容等级，获得更多奖励金」 |
| 使用体验描述 | 「详细描述使用体验、上传维修后实拍图，有助于提升评价等级，补发差额奖励」 |
| 超质保期正向反馈 | 「质保期后若维修质量依然很好，说明服务商品质优秀，有机会提升等级」 |
| 配件不匹配 | 「若配件与承诺不符，上传配件编号对比、合规渠道查询证明，不受时间限制可影响评价」 |
| 可选补充 | 「维修明细单、新旧件对比、施工过程图等高质量凭证，有助于升级为优质/标杆评价」 |

## 追评判定规则说明（用户可见简要版）

| 场景 | 对等级的影响 |
|------|--------------|
| 质保期内 | 正常评估，可升级 |
| 质保期后 · 质量依然好 | 可升级（说明服务商品质优秀） |
| 质保期后 · 故障复发 | 不提升等级（属正常磨损） |
| 配件与承诺不符 | 提供凭证（配件编号对比、非原厂证明）可影响评价，不受时间限制 |

## 弹窗参数

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| review_id | string | 是 | 主评价 ID |
| order_id | string | 否 | 订单 ID（若接口需要） |
| is_return_visit | boolean | 否 | 是否返厂评价 |

## 交互逻辑

1. **触发**：订单详情/评价详情/消息中心入口，或推送点击 → 直接打开弹窗，无页面跳转。
2. **不满足条件**：弹窗不展示或提示「该订单暂不可追评」。
3. **提交**：校验必填（客观题 + 字数）→ 调用 followup 接口 → 展示结果 → 关闭弹窗。可多次追加。

## 依赖接口

| 接口 | 方法 | 说明 |
|------|------|------|
| /api/v1/reviews/{id} | GET | 获取主评价详情，用于校验和展示 |
| /api/v1/reviews/{id}/followup | POST | 提交追评；扩展：`is_return_visit`、客观题答案、字数校验、凭证上传；需传入订单质保期用于判定 |

## 后端依赖

- **订单质保期**：需从 repair_plan 或订单获取质保期（warranty），用于追评判定。
- **可选推送**：可在 1 个月/3 个月推送提醒用户追加追评，非强制。

## 异常与边界

- 多次追评：每次提交均触发整体重评，可多次追加。
- 消息中心：可提供追评入口，点击后弹窗展示。
