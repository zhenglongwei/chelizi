# 竞价详情与报价页

## 基本信息

| 项目 | 说明 |
|------|------|
| 页面路径 | `/pages/merchant/bidding/detail/index` |
| 页面标识 | 竞价详情、提交报价 |
| 载体 | 微信小程序 |
| 入口 | 竞价邀请列表点击卡片 |

## 页面功能概述

服务商查看竞价详情（含 AI 定损报告、车辆信息、保险类型等），填写**报价明细**（零配件、工艺、价格）、工期、质保后提交报价。**评价从报价开始**：报价阶段列明维修项目与价格，便于后期与实际施工对比。

## 页面布局结构

| 模块 | 说明 |
|------|------|
| 定损报告卡片 | 车辆、支付方式（保险/自费）、保险时含事故类型/保险公司/对家保险/主责方、AI 预估区间、损伤部位、AI 维修建议；复杂度等级（L1-L4） |
| 报价明细 | 每项含：损失部位、维修方案（换/修）+ 配件类型（换时四选一）；支持「采用 AI 建议」、新增/删除/编辑 |
| 增值服务 | 如代步车、上门接送等，每项一行，服务商自行填写 |
| 总报价 | 用户自行填写 |
| 工期、质保、备注 | 工期（天）、质保（月）、备注（选填） |
| 提交按钮 | 提交报价 |

## 功能点详细说明

### 功能点 1：查看定损报告

| 项目 | 说明 |
|------|------|
| 功能 ID | F-M-BID-DETAIL-001 |
| 功能描述 | 展示 AI 定损报告供报价参考 |
| 操作流程 | 进入页面自动加载 |
| 预期结果 | 展示损伤部位、维修建议、预估价格 |
| 备注 | 与车主端定损报告一致，来自 damage_reports |

### 功能点 2：提交报价

| 项目 | 说明 |
|------|------|
| 功能 ID | F-M-BID-DETAIL-002 |
| 功能描述 | 服务商提交报价（含明细，供后期评价对比） |
| 操作流程 | 可「采用 AI 建议」预填或手动添加报价明细（损失部位、维修方案、配件类型）→ 填写总报价、工期、质保、备注 → 提交 |
| 预期结果 | 提交成功，报价及 items 写入 quotes 表，提示「报价已提交」 |
| 限制 | 同一竞价同一店铺只能报价一次 |

### 功能点 3：联系车主

| 项目 | 说明 |
|------|------|
| 功能 ID | F-M-BID-DETAIL-003 |
| 功能描述 | 可选，展示车主联系方式或通过平台联系 |
| 备注 | 按产品规则，可能不直接展示车主手机号 |

## 页面参数

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| id | string | 是 | 竞价 ID（bidding_id） |

## 交互逻辑

1. **进入页面**：根据 id 加载竞价详情、定损报告。
2. **填写报价**：报价金额必填；维修项目可预设或自定义；工期、质保有默认值。
3. **提交**：校验金额 > 0 → 调用报价接口 → 成功则提示并返回列表或详情。

## 依赖接口

| 接口 | 方法 | 说明 |
|------|------|------|
| /api/v1/merchant/bidding/:id | GET | 获取竞价详情；响应扩展：`complexity_level`、`reward_tier`（订单分级） |
| /api/v1/merchant/quote | POST | 提交报价，请求体 { bidding_id, amount, items, duration, warranty, remark } |

## 异常与边界

- 竞价不存在或已结束：提示并返回。
- 本店已报价：提示「您已提交过报价」。
- 本店不在竞价范围内：提示「该竞价未邀请您」。
- 报价金额非法：提示「请输入有效金额」。
