# 服务商订单详情页

## 基本信息

| 项目 | 说明 |
|------|------|
| 页面路径 | `/pages/merchant/order/detail/index` |
| 页面标识 | 订单详情、接单、更新状态 |
| 载体 | 微信小程序 |
| 入口 | 服务商订单列表点击卡片 |

## 页面功能概述

展示订单完整信息，支持接单（待接单→维修中）、更新状态（维修中→待确认），联系车主等操作。

## 页面布局结构

| 模块 | 说明 |
|------|------|
| 订单状态 | 待接单、维修中、待确认、已完成 |
| 车辆信息 | 车牌、车型、定损概要 |
| 报价详情 | 报价金额、维修项目、工期、质保；**分复杂度基准佣金比例（L1:4%-8%、L2:8%-12% 等，按车型分级）** |
| 车主信息 | 联系方式（按规则展示） |
| 操作按钮 | 接单、更新为待确认、联系车主 |

## 功能点详细说明

### 功能点 1：接单

| 项目 | 说明 |
|------|------|
| 功能 ID | F-M-ORD-DETAIL-001 |
| 功能描述 | 服务商接单，订单状态 0→1 |
| 操作流程 | 待接单时点击「接单」→ 确认 |
| 预期结果 | 状态变为维修中；可通知车主 |
| 限制 | 仅 status=0 时显示 |

### 功能点 2：更新为待确认

| 项目 | 说明 |
|------|------|
| 功能 ID | F-M-ORD-DETAIL-002 |
| 功能描述 | 维修完成后，服务商标记为待用户确认 |
| 操作流程 | 维修中时点击「维修完成」→ 确认 |
| 预期结果 | 状态变为待确认（2）；车主端可「确认完成」 |
| 限制 | 仅 status=1 时显示 |

### 功能点 3：联系车主

| 项目 | 说明 |
|------|------|
| 功能 ID | F-M-ORD-DETAIL-003 |
| 功能描述 | 拨打电话或通过平台联系 |
| 操作流程 | 点击联系车主 |
| 预期结果 | 调起拨号或客服 |

### 功能点 4：查看报价与车辆信息

| 项目 | 说明 |
|------|------|
| 功能 ID | F-M-ORD-DETAIL-004 |
| 功能描述 | 展示订单关联的报价、车辆、定损信息；**佣金比例、复杂度等级、订单分级** |
| 操作流程 | 进入页面自动加载 |
| 预期结果 | 信息完整展示；佣金按车型分级展示（L1:4%-8%、L2:8%-12% 等） |
| 依赖接口扩展 | 响应含 `commission_rate`、`complexity_level`、`order_tier` |

## 页面参数

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| id | string | 是 | 订单 ID（order_id） |

## 交互逻辑

1. **进入页面**：根据 id 加载订单详情，校验是否本店订单。
2. **状态驱动**：根据 status 展示不同操作（接单、维修完成）。
3. **接单**：确认后调用接单接口。
4. **维修完成**：确认后调用更新状态接口。

## 依赖接口

| 接口 | 方法 | 说明 |
|------|------|------|
| /api/v1/merchant/orders/:id | GET | 获取订单详情 |
| /api/v1/merchant/orders/:id/accept | POST | 接单，status 0→1 |
| /api/v1/merchant/orders/:id/status | PUT | 更新状态，请求体 { status }，如 1→2 |

## 异常与边界

- 订单不存在或非本店：提示并返回。
- 重复接单：接口幂等或提示已接单。
- 车主已取消：展示已取消，隐藏接单等操作。
