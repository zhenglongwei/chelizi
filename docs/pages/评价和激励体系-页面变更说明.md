# 评价和激励体系 - 页面功能与接口变更说明

本文档基于《评价和激励体系.md》V1.0，罗列车主端、服务商端、后台运维三端需修改或新增的页面功能、接口及数据字段。**不涉及代码实现**，仅作需求与设计索引。

> **前端 1:1 落地说明**：主评价页与追评弹窗的详细交互、模块内容、必填规则等，见协作规范或项目内《二、前端页面落地说明》，可直接交付开发。

---

## 〇、评价与激励流程（流程图索引）

> 以下流程与《评价和激励体系.md》及流程图一致，供开发/测试对照。

```
【流程起点】用户确认维修完工 + 平台完成分账结算
    （配置 require_settlement_before_review=0 时可提前弹出，平台提前返现）
         ↓
【主评价页】弹出，1 屏 3 模块 1 次提交
    - 模块 1 报价服务：全订单选填，不影响基础奖励
    - 模块 2 维修过程：三级/四级必填，一级/二级选填
    - 模块 3 完工验收：全订单必填
         ↓
【用户提交】→ AI 秒级审核
         ↓
    ┌────┴────┐
    │ 不通过   │ 通过
    ↓         ↓
标注缺项    立即发放基础奖励
引导补充    - 一级/二级：100% 全额
无次数限制  - 三级/四级：50% 基础
无惩罚      （剩余由追评发放）
    ↓         ↓
重新提交    【1 个月追评弹窗】维修完工第 1 个月推送
             - 一级/二级选填：额外权益（车险券等），不影响基础
             - 三级必填：通过发剩余 50%
             - 四级必填：通过发 30%
                  ↓
             【3 个月追评弹窗】仅四级，完工第 3 个月推送
             - 四级必填：通过发剩余 20%
                  ↓
             【流程终点】全流程评价完成，奖励全额发放
```

---

## 一、术语与规则变更（全局）

| 原术语 | 新术语 / 规则 |
|--------|---------------|
| 返点 | 奖励金 |
| 返点比例（8%/2%） | 奖励金三级校准（复杂度 + 车价 + 维修金额） |
| 一次性评价 | 全链路 4 阶评价闭环 |
| 好评率影响排序 | 服务商排序与好评率完全脱钩 |

---

## 二、车主端变更

**说明**：4 阶评价（报价服务、维修过程、完工验收、追评）中，**前 3 阶整合为主评价页**，服务完成后 1 次提交；**第 4 阶为追评弹窗**，1 个月/3 个月通过推送+站内信弹窗触发，非独立页面。给车主足够时间发现问题。返厂评价等同于追评，复用追评弹窗。

### 2.1 修改页面

#### 05 - 主评价页（核心页面，1 屏到底，仅 1 次提交）

| 变更项 | 原设计 | 新设计 |
|--------|--------|--------|
| 触发时机 | 维修完成后 | 用户点击「确认维修完工」后立即全屏弹出（**是否需等分账完成由后台配置**，平台可提前返现）；不可跳过（可最小化，24 小时内再次打开 APP 强制弹出） |
| 页面结构 | 维修后照片 + AI 对比 + 星级 + 返点 | **单页 1 屏到底**，整合前 3 阶：模块 1 报价服务、模块 2 维修过程、模块 3 完工验收 |
| 顶部固定 | - | **合规提示**（强制，不可滚动隐藏）：奖励仅与评价内容的完整性、真实性挂钩，与评价正负倾向完全无关，差评达标也可全额领取奖励 |
| 提交按钮 | - | 固定在页面底部，实时显示「必填项完成进度」；必填项未完成时置灰，完成后高亮可点击 |
| 模块 1 报价服务 | - | 2 道客观勾选题（结算价与报价是否一致、是否提前告知收费）+ 选填描述；全订单选填；完成可领合作商家洗车/全车检测权益，不影响基础奖励 |
| 模块 2 维修过程 | - | 材料上传区（按订单分级标注必填/选填）+ 3 道客观题（配件型号一致、项目与故障匹配、是否同步进度）；三级/四级必填，一级/二级选填；未完成则无法提交（三级/四级） |
| 模块 3 完工验收 | - | 必传：维修结算清单、完工实拍图 2 张；4 道客观题（故障已解决、已告知质保、服务商一致、无额外项目）；主观描述（按订单分级字数）；选填 5 维度星级；全订单 100% 必填 |
| 审核不通过 | - | 标注明确缺项，引导用户补充，**无提交次数限制，无惩罚** |
| 奖励规则 | 首次 8% | 一级/二级：审核通过 100% 全额；三级/四级：审核通过发 50% 基础奖励，剩余 50%/50% 由 1 个月/3 个月追评发放 |
| 依赖接口 | `POST /api/v1/reviews` | 扩展请求体：各模块材料、客观题答案、主观描述；`GET /api/v1/orders/{id}/reward-preview` 奖励金预估 |

#### 14 - 返点余额明细页 → 奖励金余额明细页

| 变更项 | 原设计 | 新设计 |
|--------|--------|--------|
| 页面标识 | 返点余额、返点明细 | 奖励金余额、奖励金明细 |
| 明细类型 | 评价返点（首次/追评/返厂） | 评价奖励金（按订单分级、评价阶段区分）、个税说明（≤800 元无税） |
| 提现规则 | 最低 10 元 | 维持；增加「单次奖励 ≤800 元无需扣税」说明 |
| 依赖接口 | `GET /api/v1/user/balance` | 响应扩展：明细项增加 `reward_tier`、`review_stage`、`tax_deducted` 等字段 |

#### 15 - 追评弹窗（第四阶，极简轻量化，非独立页面）

| 变更项 | 原设计 | 新设计 |
|--------|--------|--------|
| **交互形式** | 独立追评页 | **弹窗**（APP 推送 + 站内信弹窗，点击直接打开，无跳转，10 秒可完成） |
| 1 个月追评弹窗 | - | 维修完工后第 1 个月推送；1 屏极简；2 道客观题（故障是否复发、有无新增异常）+ 10 字以上使用体验描述；三级/四级必填，一级/二级选填（选填完成可领车险优惠券）；给车主足够时间发现问题 |
| 3 个月追评弹窗 | - | 维修完工后第 3 个月推送；**仅四级订单展示**，一级/二级/三级不展示；3 道客观题（故障复发、配件正常、售后响应）+ 20 字以上长期描述 |
| 奖励规则 | 2% 返点 | 三级：7 天通过发剩余 50%；四级：7 天发 30%、30 天发剩余 20% |
| 返厂评价 | - | 等同于追评，复用追评弹窗流程 |
| 依赖接口 | `POST /api/v1/reviews/{id}/followup` | 扩展：`stage`（1m/3m）、`is_return_visit`（是否返厂）、客观题答案、必填字数校验 |

#### 04 - 维修厂详情页

| 变更项 | 原设计 | 新设计 |
|--------|--------|--------|
| 评价展示 | 综合评分、分项、列表 | 评价 100% 完整公示，好评差评一视同仁；差评下方标注「该用户已完成全部评价要求，全额领取对应奖励」 |
| 排序规则 | 可能隐含好评优先 | 按「内容完整度优先、发布时间最新」排序，不设好评优先；用户可自主切换筛选维度 |

#### 10 - 维修厂搜索列表页

| 变更项 | 原设计 | 新设计 |
|--------|--------|--------|
| 排序依据 | 可能含评分/好评率 | **与好评率完全脱钩**，仅与以下 6 项绑定：AI 校验维修合规率、投诉率与纠纷解决率、资质等级与技师持证、报价响应与透明度、质保与售后履约、入驻时长与履约率 |
| 依赖接口 | `GET /api/v1/shops/search` | 请求/响应扩展：移除或弱化 `rating` 排序权重，新增 `compliance_rate`、`response_speed` 等排序字段 |

#### 06 - 个人中心页

| 变更项 | 说明 |
|--------|------|
| 入口文案 | 「我的钱包」「返点余额」 | 改为「奖励金余额」或「我的奖励金」 |
| 跳转目标 | `/pages/user/balance` | 不变，页面内容见 14 |

#### 07 - 订单详情页

| 变更项 | 说明 |
|--------|------|
| 确认完工 | 用户点击「确认维修完工」后弹出主评价页；是否需等平台分账完成由**后台配置**决定（平台可提前返现） |
| 追评 | 1 个月/3 个月追评为**弹窗**推送，非页面跳转；消息中心可提供追评入口作为补充（点击后弹窗展示） |
| 奖励金提示 | 按订单分级展示可获奖励金预估及发放节点（基础 50%、7 天 30%、30 天 20% 等） |

---

## 三、服务商端变更

### 3.1 修改页面

#### M04 - 竞价邀请列表 / M05 - 竞价详情与报价

| 变更项 | 说明 |
|--------|------|
| 报价展示 | 报价金额 | 需展示或关联「维修项目复杂度等级」（L1-L4），供用户理解奖励金规则 |
| 依赖接口 | 报价相关 API | 响应扩展：`complexity_level`、`reward_tier`（订单分级） |

#### M06 - 服务商订单列表 / M07 - 服务商订单详情

| 变更项 | 说明 |
|--------|------|
| 订单状态 | 待接单、维修中、待确认、已完成 | 维持现有状态；评价维度在 05 单页内完成，无单独阶段状态 |
| 佣金展示 | - | 展示分复杂度基准佣金比例（L1:4%-8%、L2:8%-12% 等，按车型分级） |
| 依赖接口 | 订单相关 API | 响应扩展：`commission_rate`、`complexity_level`、`order_tier` |

#### M08 - 维修厂信息

| 变更项 | 说明 |
|--------|------|
| 新增字段 | - | 维修资质等级、技师持证情况（影响流量排序） |
| 依赖接口 | `PUT /api/v1/merchant/shop` | 请求体扩展：`qualification_level`、`technician_certs` |

### 3.2 新增能力（可能为新页面或现有页面扩展）

| 能力 | 说明 |
|------|------|
| 合规率展示 | 服务商查看本店 AI 校验维修合规率，影响流量与佣金浮动 |
| 佣金浮动规则告知 | 季度合规率≥95%、投诉率≤1% 可下调 1%；合规率＜80% 或违规则上调 2% |

---

## 四、后台运维变更

### 4.1 新增页面 / 模块

#### A10 - 奖励金规则配置（建议）

| 项目 | 说明 |
|------|------|
| 路由 | `/admin/reward-rules`（建议） |
| 功能 | 维修项目复杂度等级（L1-L4）与项目类型映射、车价分级标准、订单分级阈值、浮动比例、封顶金额 |
| 依赖接口 | `GET/PUT /api/v1/admin/reward-rules`（新增） |

#### A11 - 评价审核与人工复核（建议）

| 项目 | 说明 |
|------|------|
| 路由 | `/admin/review-audit`（建议） |
| 功能 | 异议订单、大额四级订单、异常订单的人工复核队列；持证技师执行，24h 响应、48h 出结果；全流程留痕 |
| 依赖接口 | `GET /api/v1/admin/reviews/pending`、`POST /api/v1/admin/reviews/{id}/audit`（新增） |

#### A12 - 破格升级通道审核（建议）

| 项目 | 说明 |
|------|------|
| 路由 | `/admin/complexity-upgrade`（建议） |
| 功能 | 用户申请复杂度等级升级的工单队列；持证技师复核，24h 内完成；同一用户 3 个月内最多 2 次 |
| 依赖接口 | `GET /api/v1/admin/complexity-upgrades`、`POST /api/v1/admin/complexity-upgrades/{id}/approve`（新增） |

### 4.2 修改页面

#### A05 - 规则配置 / A09 - 系统配置

| 变更项 | 说明 |
|--------|------|
| 扩展内容 | 原竞价规则、偏差惩罚 | 增加奖励金三级校准参数、评价必填模块配置、AI 审核维度配置 |
| **分账与评价** | - | **新增配置项**：是否需等平台分账完成才允许评价/返现。关闭时，确认完工即可评价，平台可提前返现；开启时，分账完成后才弹出主评价页 |
| 依赖接口 | 规则相关 API | 扩展：`reward_rules`、`review_modules`、`ai_audit_config`、`require_settlement_before_review`（或类似） |

#### A03 - 维修厂管理

| 变更项 | 说明 |
|--------|------|
| 列表/详情 | 维修厂信息 | 增加维修资质等级、技师持证、AI 合规率、投诉率、佣金浮动状态 |
| 排序/筛选 | - | 支持按合规率、投诉率、资质等排序（与好评率脱钩） |
| 依赖接口 | 维修厂相关 API | 响应扩展：`compliance_rate`、`complaint_rate`、`qualification_level` |

#### A04 - 订单管理

| 变更项 | 说明 |
|--------|------|
| 订单详情 | 订单信息 | 增加订单分级（一级~四级）、复杂度等级、奖励金核算明细、评价阶段完成情况 |
| 依赖接口 | 订单相关 API | 响应扩展：`order_tier`、`complexity_level`、`reward_breakdown`、`review_stages` |

#### A06 - 结算管理

| 变更项 | 说明 |
|--------|------|
| 结算项 | 佣金、返点 | 改为佣金、奖励金；奖励金需区分个税处理（≤800 无税、>800 平台承担） |
| 依赖接口 | 结算相关 API | 扩展：`reward_with_tax`、`tax_deducted` |

#### A08 - 数据统计

| 变更项 | 说明 |
|--------|------|
| 统计维度 | 订单量、GMV | 增加奖励金支出、按订单分级/复杂度分布、合规率分布、人工复核量 |
| 依赖接口 | 统计相关 API | 扩展：`reward_expense`、`order_tier_distribution` |

---

## 五、数据库与接口新增/变更摘要

### 5.1 新增表（建议）

| 表名 | 用途 |
|------|------|
| `repair_complexity_levels` | 维修项目复杂度等级（L1-L4）与项目类型映射 |
| `reward_rules` | 奖励金规则配置（固定奖励、浮动比例、封顶、车型系数） |
| `review_dimensions` | 评价维度记录（报价、过程、完工，单次评价内；追评单独记录） |
| `review_audit_logs` | AI 审核与人工复核留痕 |
| `complexity_upgrade_requests` | 用户破格升级申请及审核记录 |

### 5.2 现有表扩展字段（建议）

| 表 | 新增/变更字段 |
|----|---------------|
| `orders` | `order_tier`、`complexity_level`、`vehicle_price_tier`、`reward_preview`、`review_stage_status` |
| `reviews` | `review_stage`、`settlement_list_image`、`completion_images`、客观题答案 JSON、`reward_amount`、`tax_deducted` |
| `shops` | `compliance_rate`、`complaint_rate`、`qualification_level`、`technician_certs` |
| `transactions` | `reward_tier`、`review_stage`、`tax_deducted` |

### 5.3 新增/变更接口清单

| 接口 | 方法 | 说明 |
|------|------|------|
| `/api/v1/reviews` | POST | 服务完成后评价（单次提交，请求体含报价/维修过程/完工验收各维度） |
| `/api/v1/reviews/{id}/followup` | POST | 追评（1 个月/3 个月；返厂评价复用此接口，扩展 `is_return_visit`） |
| `/api/v1/orders/{id}/reward-preview` | GET | 奖励金预估 |
| `/api/v1/admin/reward-rules` | GET/PUT | 奖励金规则配置 |
| `/api/v1/admin/reviews/pending` | GET | 待人工复核评价列表 |
| `/api/v1/admin/reviews/{id}/audit` | POST | 人工复核提交 |
| `/api/v1/admin/complexity-upgrades` | GET | 破格升级申请列表 |
| `/api/v1/admin/complexity-upgrades/{id}/approve` | POST | 破格升级审核 |
| `/api/v1/shops/search` | GET | 扩展排序字段（脱钩好评率） |
| `/api/v1/shops/:id` | GET | 扩展合规率、投诉率等 |
| `/api/v1/user/balance` | GET | 扩展奖励金明细字段 |

---

## 六、分阶段落地对照

| 阶段 | 周期 | 涉及页面与接口 |
|------|------|----------------|
| 第一阶段 | 1-2 月 | 05 评价页改造（单页增加报价/服务过程等维度）、14 奖励金余额、基础奖励规则、AI 初审；一级/二级订单 |
| 第二阶段 | 3-4 月 | 15 追评改造（含返厂评价合并）、16 取消；三级/四级订单；人工复核 |
| 第三阶段 | 5-6 月 | 04/10 排序规则脱钩、M 端合规率展示、A 端审核与破格通道 |
| 第四阶段 | 持续 | 高端车型权益池、隐私保护、反作弊强化 |

---

## 七、前端页面落地说明（1:1 交付开发）

以下为主评价页与追评弹窗的详细规则，可直接交付开发还原。

### （一）主评价页

| 项目 | 说明 |
|------|------|
| 触发时机 | 用户点击「确认维修完工」后立即全屏弹出（是否需等分账完成由后台配置）；不可跳过（可最小化，24 小时内再次打开 APP 强制弹出） |
| 顶部固定 | 合规提示（强制，不可滚动隐藏）：奖励仅与评价内容的完整性、真实性挂钩，与评价正负倾向完全无关，差评达标也可全额领取奖励 |
| 提交按钮 | 固定在底部，实时显示「必填项完成进度」；必填项未完成时置灰，完成后高亮可点击 |
| 审核不通过 | 标注明确缺项，引导用户补充，无提交次数限制，无惩罚 |

**模块 1 报价服务**：2 道客观勾选题（结算价与报价是否一致、是否提前告知收费）+ 选填描述；全订单选填；完成可领合作商家洗车/全车检测权益。

**模块 2 维修过程**：材料上传区（按订单分级标注必填/选填）+ 3 道客观题（配件型号一致、项目与故障匹配、是否同步进度）；三级/四级必填，一级/二级选填；上传材料实时显示 AI 识别结果，缺项标红。

**模块 3 完工验收**：必传维修结算清单、完工实拍图 2 张；4 道客观题（故障已解决、已告知质保、服务商一致、无额外项目）；主观描述（按订单分级字数）；选填 5 维度星级（报价透明度、服务态度、完工时效、维修环境、售后响应）。

### （二）追评弹窗

| 弹窗 | 适用订单 | 必填规则 | 内容 | 奖励 |
|------|----------|----------|------|------|
| 1 个月 | 三级/四级 | 必填 | 2 道客观题（故障是否复发、有无新增异常）+ 10 字以上描述 | 三级发剩余 50%，四级发 30% |
| 1 个月 | 一级/二级 | 选填 | 同上 | 完成可领车险优惠券 |
| 3 个月 | 四级 | 必填 | 3 道客观题（故障复发、配件正常、售后响应）+ 20 字以上描述 | 发剩余 20% |
| 3 个月 | 一级/二/三级 | 不展示 | - | - |

触发：APP 推送 + 站内信弹窗，点击直接打开，无跳转，10 秒可完成。

---

## 八、文档同步

- 本文档为《评价和激励体系.md》的页面落地索引，具体页面功能细节需同步更新 `docs/pages/XX-页面名.md`
- 数据库变更需同步更新 `docs/database/数据库设计文档.md` 与 `web/database/schema.sql`
- 接口变更需同步更新各页面对应的功能说明文档及 API 文档
