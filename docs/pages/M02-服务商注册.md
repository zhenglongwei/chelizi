# 服务商注册页

## 基本信息

| 项目 | 说明 |
|------|------|
| 页面路径 | `/pages/merchant/register` |
| 页面标识 | 服务商注册、维修厂注册 |
| 载体 | 微信小程序 |
| 入口 | 车主端 个人中心 → 设置 → 服务商注册；或登录页「去注册」 |

## 页面功能概述

维修厂/服务商提交注册申请，填写企业基本信息（不含维修资质等级）。提交后自动审核通过，直接跳转补充信息页完善资质、照片、技师等，无需先登录。

## 页面布局结构

| 模块 | 说明 |
|------|------|
| 服务商端标识 | 标明为维修厂/服务商注册 |
| 资质上传 | 营业执照（置顶，上传后 OCR 自动填充企业名称、营业执照号码、法定代表人） |
| 注册表单 | 企业名称、营业执照号码、法定代表人、联系人、店铺地址（wx.chooseLocation 地图选点，含经纬度）、手机号、密码、确认密码 |
| 注册按钮 | 提交注册 |
| 登录入口 | 已有账号，去登录 |

**字段说明**：
- 法定代表人（营业执照上的法人）与联系人（日常业务对接人）为不同概念，均需填写。
- **维修资质等级**：注册阶段不展示，由补充信息页根据营业执照/资质证明识别结果处理。

## 功能点详细说明

### 功能点 1：提交注册

| 项目 | 说明 |
|------|------|
| 功能 ID | F-M-REG-001 |
| 功能描述 | 维修厂/服务商提交注册申请 |
| 操作流程 | 上传营业执照（OCR 自动填充）→ 填写/核对企业名称、营业执照号码、法定代表人、联系人、店铺地址、手机号、密码 → 提交 |
| 预期结果 | 提交成功，提示「注册成功，请补充资质信息」并**直接跳转补充信息页**（无需登录） |
| 备注 | 注册后创建 merchant_users、shops；基本信息免审；维修资质等级在补充信息页处理 |

### 功能点 2：去登录

| 项目 | 说明 |
|------|------|
| 功能 ID | F-M-REG-002 |
| 功能描述 | 跳转服务商登录页 |
| 操作流程 | 点击「已有账号，去登录」 |
| 预期结果 | 跳转 `/pages/merchant/login` |

## 注册与补充信息流程

1. **注册页**：仅填写基本信息，维修资质等级不展示。营业执照 OCR 结果（含 qualification_ai_recognized、qualification_ai_result）静默传后端供补充页使用。
2. **提交后**：后端返回 token，前端保存并跳转 `/pages/merchant/shop/profile/index`（补充信息页）。
3. **补充信息页**：
   - 若营业执照已识别出维修资质等级：直接展示，用户可确认；
   - 若未识别：要求上传资质证明（AI 识别）；若仍失败则支持手动选择（提交人工审核）；
   - 服务商照片、技师持证等：按原 AI 优先策略审核。

## 页面参数

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| 无 | - | - | - |

## 交互逻辑

1. **进入页面**：从设置或登录页跳转。
2. **提交**：校验必填项、手机号格式、密码强度 → 调用注册接口。
3. **成功**：保存 token → 提示「注册成功，请补充资质信息」→ 跳转补充信息页。

## 依赖接口

| 接口 | 方法 | 说明 |
|------|------|------|
| /api/v1/merchant/register | POST | 服务商注册；请求体含 name, license_id, legal_representative, contact, address, latitude, longitude, phone, password, license_url?；可选传 qualification_ai_recognized、qualification_ai_result（OCR 结果，供补充页使用）；返回 token |

## 异常与边界

- 手机号已注册：提示「该手机号已注册」。
- 企业名称重复：按业务规则处理。
- 审核中再次访问：可提示「您的账号正在审核中」。
